name: Download archive

on:
  schedule:
    - cron: '0 3 * * 0'  # At 03:00 on Sunday

jobs:
  backup:
    name: Download archive
    runs-on: ubuntu-latest
    timeout-minutes: 30

    steps:

    # Download the migration.data.id as an artifact at the beginning of the second run
    - name: Archive Data
      uses: actions/download-artifact@v2
      with:
        name: migration-data
        path: migration_response.json

    - name: Github Migrations Backup
      uses: skrepr/github-backup-action@1.0.0
      with:
        download-migration: true
        github-organization: "your-organization-here"
        github-apikey: ${}
        aws-bucket-name: "your-bucket-here"
        aws-bucket-region: "your-bucket-region-here"
        aws-access-key: ${AWS_ACCESS_KEY} # Github Secret is advised
        aws-secret-key: ${AWS_SECRET_KEY} # Github Secret is advised